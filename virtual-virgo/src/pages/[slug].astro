---
import Header from '../components/01_Header.astro';
import Layout from '../layouts/Layout.astro';
import Footer from '../components/Footer.astro';
import wp from '../lib/wordpress.js'; 
import ArtikelKlein from '../components/ArtikelKlein.astro';

export async function getStaticPaths() {
    const posts = await wp.posts().perPage();

    const paths = posts.map(post => ({
        params: { slug: post.slug }
    }));

    return paths;
}

const { slug } = Astro.params;

const posts = await wp.posts().perPage();
const post = posts.find(p => p.slug === slug);

const postContent = post ? post.content.rendered : "Geen inhoud beschikbaar."; 
---

<Layout title={slug}>


<Header />

<main>
    {post ? (
        <article>
            <h1>{post.title.rendered}</h1>
            <div>{postContent}</div> 
            <p>door <strong>{post.yoast_head_json?.author || "Onbekende auteur"}</strong></p>
            <p>{post.excerpt.rendered}</p>
        </article>
    ) : (
        <p>Geen post beschikbaar</p> 
    )}
</main>

<div class="artikel-klein">
<ArtikelKlein/>
</div>

<Footer />

<style>

    main {
        max-width: var(--article-width);
        padding: 0 1em;
    }

    article {
        margin-top: 2em;
    }

    .artikel-klein{
        align-items: center;
        display: flex;
        justify-content: center;
    }
</style>
